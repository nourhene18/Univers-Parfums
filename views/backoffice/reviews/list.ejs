<div class="page">

  <div class="page-header center">
    <h1>Avis clients</h1>
    <p class="subtitle">Modération et visibilité des avis</p>
  </div>

  <div class="card">

    <form method="get" class="filters">

      <div class="filters-left">

        <div class="form-group">
          <label>Parfum</label>
          <select name="parfum">
            <option value="">Tous</option>
            <% parfums.forEach(p => { %>
              <option value="<%= p._id %>"
                <%= parfum == p._id ? 'selected' : '' %>>
                <%= p.nom %>
              </option>
            <% }) %>
          </select>
        </div>

        <div class="form-group">
          <label>Visibilité</label>
          <select name="visible">
            <option value="">Toutes</option>
            <option value="true" <%= visible==='true'?'selected':'' %>>
              Visible
            </option>
            <option value="false" <%= visible==='false'?'selected':'' %>>
              Masqué
            </option>
          </select>
        </div>

        <div class="form-group">
          <label>Note</label>
          <select name="note">
            <option value="">Toutes</option>
            <% [5,4,3,2,1].forEach(n => { %>
              <option value="<%= n %>" <%= note==n?'selected':'' %>>
                <%= n %> ⭐ 
              </option>
            <% }) %>
          </select>
        </div>

        <div class="form-group">
          <label>&nbsp;</label>
          <button class="btn filter-btn" type="submit">
            Filtrer
          </button>
        </div>

      </div>

    </form>

    <table class="table-elegant">

      <thead>
        <tr>
          <th>Parfum</th>
          <th>Utilisateur</th>
          <th>Note</th>
          <th>Visibilité</th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        <% reviews.forEach(r => { %>
          <tr>
            <td class="strong"><%= r.parfum.nom %></td>

            <td>
              <%= r.user.prenom %> <%= r.user.nom %>
            </td>

           
            <td>
              <strong><%= r.note %> ⭐</strong>
            </td>

            <td>
              <span class="badge">
                <%= r.visible ? 'Visible' : 'Masqué' %>
              </span>
            </td>

            <td>
              <a href="/backoffice/reviews/<%= r._id %>"
                 class="btn small secondary">
                Détails
              </a>
            </td>
          </tr>
        <% }) %>

        <% if (!reviews.length) { %>
          <tr>
            <td colspan="5" class="empty">
              Aucun avis pour le moment
            </td>
          </tr>
        <% } %>

      </tbody>
    </table>

  </div>
</div>
